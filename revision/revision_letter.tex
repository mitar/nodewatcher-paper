\documentclass[12pt,twoside,a4paper]{report}

\usepackage{graphicx}
\usepackage[utf8]{inputenc}
\usepackage[margin=0.7in]{geometry}
\usepackage[normalem]{ulem}
\usepackage[sc]{mathpazo}
\usepackage[T1]{fontenc}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}

\usepackage{multirow}
\usepackage{ctable}
\usepackage{colortbl}
\usepackage{subfig}
\usepackage{dcolumn}
\usepackage{url}


\newcommand{\myspace}{5cm}

\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{listings}
\usepackage{url}

% ADDED
\usepackage{ctable}
\usepackage{subfig}
\usepackage{array}
\usepackage{multirow}
\usepackage{colortbl}
\usepackage[shortcuts]{extdash}

% nested calls
\renewcommand*\Call[2]{\textproc{#1}(#2)}

% NEW COMMANDS
\newcommand{\otoprule}{\midrule[\heavyrulewidth]}
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

% Function names
\DeclareMathOperator{\Trust}{Trust}
\DeclareMathOperator{\Aggregate}{Aggregate}
\DeclareMathOperator{\Median}{Median}
\DeclareMathOperator{\mor}{mor}
\DeclareMathOperator{\MOR}{MOR}
\DeclareMathOperator{\Rank}{\textsc{Rank}}
\DeclareMathOperator*{\argmin}{\arg\!\min}

% elements
\newcommand{\D}{\mathit{D}}
\newcommand{\PD}{\mathit{PD}}
\newcommand{\I}{\mathit{I}}
\newcommand{\PT}{\mathit{PT}}
\newcommand{\T}{\mathit{T}}

% algs
\floatname{algorithm}{Listing}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}
\newcommand{\pushcode}[1][1]{\hskip\dimexpr#1\algorithmicindent\relax} % for condition over two lines

\newcommand{\nodewatcher}{\textit{nodewatcher}}
\newcommand{\wlanslovenija}{\textit{wlan slovenija}}

\frenchspacing
\begin{document}%\maketitle
\pagestyle{empty}
\begin{center} {\Large{Authors' response to the review of the paper COMNET-D-15-148}}\\
    ``\emph{\nodewatcher{}: A Substrate for Growing Your own Community Network}''\\
    submitted to Computer Networks
\end{center}

\noindent We would like to thank the Editor and the reviewers for their comments. We have found them to be very constructive and they have helped us greatly to improve the manuscript. On the subsequent pages we provide detailed responses to the reviewers' comments and we indicate the modifications that we made in the text. The following list represents the major changes.
\begin{itemize}
\item TBD
\end{itemize}

\noindent In addition to these major changes (which are in detail explained in the subsequent pages as responses to concrete comments from the reviewers), we have also made several minor changes (corrected spelling mistakes, shortened some paragraphs, ...) that we do not highlight in this revision letter.

\noindent When providing responses (and marking corresponding changes in the manuscript), we denote existing references with numbers in square brackets, for instance [1], while we denote newly added references in full by inlining them.\\
\\
\noindent Sincerely,\\
Jernej Kos, Mitar Milutinović and Luka Čehovin

\newpage

\section*{Response to Reviewer \#1}

\vspace{0.5cm}\noindent\textsc{General}\\
\noindent The paper presents  the design choices of nodewatcher, a community network management system. The design is valuable. The idea of starting from a platform independent configuration and then of producing a device dependent firmware to easy the configuration, monitoring and maintenance procedures sounds very good. Also to include the monitoring in the platform itself to validate presumed configurations with actual ones is a nice idea.
Overall the "work" is valuable and it is extremely relevant with the call for paper.

\vspace{0.5cm}\noindent\textsc{Comment 1}\\
However the paper is a little bit boring. The authors  have difficulty in simply explaining at higher level the system architecture and get the discussion in too much details, in order to motivate any choice. It would be better to introduce an overview section with highlights all the user/administrator steps from the user decision to participate to the community network up to the time when her node is operational. By sequentially of describing each piece of the (good) system, the reader have a complete view only at the end. And this discourage the reading. In would be better to provide a bird-eye-view at the start of the paper. 

\vspace{0.2cm}\noindent\textsc{Response}\\
TODO

\newpage

\section*{Response to Reviewer \#2}

\vspace{0.5cm}\noindent\textsc{General}\\
The authors present the v3 of "nodewatcher" a new community network management platform built around the core principle of modularity and extensibility and discuss its implementation in wlan slovenija, a CN in Slovenia, and claim to be a general solution for CNs. The paper is well written and the authors show a wide theoretical and practical knowledge on the topic. The design of nodewatcer v3 takes into account the learning from its previous versions as well as from the results of the analysis of other CNs management platforms. Nodewatcher integrates the "device manage cycle" to automate the configuration and monitoring tasks, which is a good idea but which implementation raises doubts due to the inherent challenges and the expected assumptions required to put into practice. The modular design of the data base is a good solution to the limitations of the implementations of other CNs.

The platform uses up to date technologies (json, etc.), is well documented (although there are still some "TODO" sections) and includes nice features such as a real-life demo or a Docker development environment. Although the work presented is a good contribution towards the noble and (utopian?) "CN-independent" solution objective, in this author opinion, despite the authors claim, the solution is still tight to some of the developers' CN traits.

\vspace{0.5cm}\noindent\textsc{Comment 1}\\
Please discuss: 1) how nodewatcher with hardware diversity and novelty. Which are the constrains (e.g. OpenWRT like firmwares required? Implications of requirement of having to install a daemon in each node). Recommendations for new adopters and specially for (massive) migrations.

\vspace{0.5cm}\noindent\textsc{Response}\\
Regarding hardware diversity, we have now added a subsection detailing how \nodewatcher{} is able to deal with hardware diversity and novelty.
The subsection now contains the following paragraphs.

\begin{quote}
Hardware device use may vary a lot between different community networks.
Additionally, new hardware is being developed all the time.
Therefore in order for the platform to really be useful, it must make it really easy to support new devices and even whole new operating systems.
To enable this, \nodewatcher{} splits hardware support into different components, which may be provided by independent modules:

\begin{description}
    \item[Runtime platform.] The runtime platform is dependent upon the operating system that runs on the target device.
    As mentioned, \nodewatcher{} supports OpenWrt out of the box.
    But there is no hardcoded concept of how a platform should behave.
    What defines the runtime platform are the transformation modules, which contain the logic of converting the platform-independent configuration into something that can be understood by the target device.

    \item[Firmware builders.] Separate from the runtime platform are the firmware builders.
    They contain toolchains, which are able to generate firmware images that may be copied directly onto the target device.
    In case the devices are using proprietary operating systems, these may not even exist.
    Decoupling the builders from the runtime platform means that proprietary runtime platforms can also be supported.
    In such cases, configuration will still need to be applied manually.

    \item[Hardware device descriptors.] These are the device descriptors that we have already defined.
    They provide to the transformation modules the knowledge required to correctly adapt the platform-dependent configuration to the target device.
    Since a device may in theory support different runtime platforms (eg. some Mikrotik devices may use either OpenWrt or RouterOS), the same device descriptor can be reused by multiple runtime platforms.
    In this case, the platform-specific properties are specified for each platform, while the common ones are specified only once for each device.
\end{description}

The only component that we have not yet described are the firmware builders.
As said, they are kept separate from the runtime platform, so that proprietary systems may be supported.
The link between the runtime platform and the firmware builders is the platform-specific configuration.
This configuration is the output of the transformation modules defined for the target runtime platform.

The toolchains used to build firmware images for embedded devices can be complex and may vary wildly between the runtime platforms.
This is why the firmware build system in \nodewatcher{} has been designed in such a way that it can be used by completely different toolchains in a modular fashion.
To achieve this, the build system is structured into multiple Docker containers~[34].
Docker containers are a lightweight wrapper around the Linux namespacing API and filesystem layers with a goal to enable an interface for packaging applications in a reusable and extensible way.
Namespaces provide container isolation (the containers still share the host kernel), so that adjacent containers running on the same host are unable to see or influence each other's processes, network configuration, etc.
Each container can be thought of as a very lightweight virtual instance, but without the overhead of running a full virtual machine with its own kernel.
\nodewatcher{} uses the Docker container features in order to generate and run firmware image builders for multiple runtime platforms.

After the platform-specific configuration has been generated by the transformation step of the given runtime platform (see the node \textit{Device and OS Specific Config.} in Figure~5), a suitable builder is selected based on the hardware architecture specified in the device descriptor.
The \nodewatcher{} platform connects to the firmware builder containers using secure shell (SSH) connections.
After a connection is established, the platform-specific configuration is transferred and the build process is started.
When the process completes (for OpenWrt, this is a matter of seconds), the generated firmware images are transferred back so they can be made available to the user.
This decoupling of platform-specific configuration and firmware builders enables the builder containers to be distributed and deployed on a cluster of machines to better handle the load, resource availability and utilization.
The described system is also extensible~-- adding support for new architectures simply requires a new builder container to be prepared, while adding support for new runtime platforms also requires an extension of the configuration transformation pipeline.
\end{quote}

Regarding installation of a daemon on each node.
In Section~3.6 we describe how the agent runs on the node, collects data and enables the \nodewatcher{} backend to acquire the data from the ndoes.
But as we mention in the following paragraph, this notion of our own monitoring agent is just one possible way of handling reporting.
We have modified the paragraph a little, to make this more clear.

\begin{quote}
But still, the implemented agent that uses JSON over HTTP(S) is just one of the possible monitoring data source implementations.
The architecture enables other data collection protocols to be used side-by-side.
One possible such protocol, that many existing device operating systems already support, is SNMP.
While our custom protocol enables easier schema evolution through per-module versions, SNMP may be used in cases where custom monitoring agents cannot be installed on target devices.
This co-existence of data sources is enabled by the modular design of the monitoring backend.
\end{quote}

\vspace{0.5cm}\noindent\textsc{Comment 2}\\
Please clarify (and discuss the consequences if appropriated): 1) if all nodes need to see each other. I.e. how isolated clouds are handled, does each need a nodewatcher? if so, what if two nodes merge. Federation. if it splits?

\vspace{0.5cm}\noindent\textsc{Response}\\
Recently, \nodewatcher{} has gained support for nodes to push data in addition to the data being pulled from them. 
This now enables setups where the nodewatcher instance does not even have access to the mesh network, but is just placed somewhere on the public Internet.
We have modified the section describing the monitoring agent to contain this new development.

\begin{quote}
It is a small C application with a minimal core that is able to periodically request the loaded modules to provide their state updates which are then compiled into the current node status and exported in a JSON form.
There are then two ways for the agent to transfer the data to the nodewatcher backend:
\begin{itemize}
    \item \textbf{Pull.} The JSON data may be served over HTTP(S) and the nodewatcher monitoring backend will periodically request new data from the nodes.

    \item \textbf{Push.} The agent on the node will periodically push its monitoring data to the backend using HTTP(S) POST requests. This requires that the push URL and interval be configured on the node.
\end{itemize}

This behaviour of the agent may be configured per-node, so some nodes may push data while data is pulled from others.
Supporting both modes of operation is beneficial for situations where the nodewatcher backend installation does not directly see every node in the mesh network, but is instead located somewhere in the public Internet, without VPN access to the network itself.
With push support, nodes may provide telemetry data even in this case, by pushing data to the public URL.
\end{quote}

By isolated clouds, we assume you mean different subcommunities, for example in large community networks that need to segment things into multiple independent routing domains.
There is currently no explicit support for federation in \nodewatcher{}.
In general, such deployments may be handled in the following ways:
\begin{itemize}
    \item Each independent routing domain would have its own \nodewatcher{} installation which performs registration and monitoring for its own nodes.
    If one then wants to have an overall picture of the whole network, another \nodewatcher{} instance may be deployed which will use pull and/or push from all the other \nodewatcher{} installations in order to generate an aggregated picture.
    Note that there is currently no support for this, but a module for aggregation of data from multiple \nodewatcher{} installations could be easily added.

    \item The problem with having multiple instances is that it may be hard to handle merge/split scenarios.
    So instead of having multiple instances, one could also use just a single instance.
    Since there is no need for the nodes to see each other (only \nodewatcher{} needs to be able to communicate with them), this is already possible using the current technology.
    One thing that would still need to be developed is a module that would enable nicer (visual) grouping of nodes.
    As far as topology visualizations go, they would already (so with the current implementation) show multiple disconnected islands.
\end{itemize}

\vspace{0.5cm}\noindent\textsc{Comment 3}\\
  2) if how to develop "monitor pipelines" presented Fig.6 is well documented, e.g. to develop one for BGP
  
\vspace{0.5cm}\noindent\textsc{Response}\\
It depends on the routing daemon that is in use.
There needs to be a way for \nodewatcher{} to connect to the routing daemon and obtain topology information and announced networks from it.
As far as I know, both Quagga and Bird expose such data via an IPC protocol (in case of Bird, there is even a Python interface for this protocol\footnote{\url{https://pypi.python.org/pypi/pybird}}).
So a module for monitoring BGP could be added.

\newpage

\section*{Response to Reviewer \#3}

\vspace{0.5cm}\noindent\textsc{General}\\
The paper briefly reviews existing traditional and specialized monitoring and management solutions for wireless community networks and then presents detailed design concepts and example use cases of the novel nodewatcher v3 platform that focuses on modularity and extensibility with the objective of being adapted by many communities and finally break the circle of letting each community reinvent the wheel and produce their own proprietary and incompatible solutions again and again.

The issue of network management represents an indeed major aspect of the daily and long-term life-cycle of community networks as well as their propagation and growth around the world and certainly deserves a (i) fundamental review of common practices, existing solutions, and open issues and (ii) the fundamental rethinking of tools and approaches.

\vspace{0.5cm}\noindent\textsc{Comment 1}\\
Particularly in the former aspect, the review given by the paper could be significantly enhanced. The paper covers in too great detail technical engineering decisions to achieve the somehow common objectives of modularity and extensibility, which are of course noble goals. But it reads a lot like a white paper or technical report that praises a bit too much its own achievements without providing sufficient quantitative or qualitative comparison or overview of existing solutions, weaknesses, unaddressed aspects or yet achieved disseminations and impacts.

A table summarizing characteristics of existing management solutions would be desirable, (e.g. showing features, addressed issues, concerns, openness, usage, age, developer community size, ...).

\vspace{0.5cm}\noindent\textsc{Response}\\
TODO

\vspace{0.5cm}\noindent\textsc{Comment 2}\\
For example the guifi.net management system is able to generate firmware configurations (building of the entire firmware is due to the closed-source policy of Mikrotik, a different issue than for openWRT based systems) from a web-user interface for many different devices. But the paper claims this as a somehow unique feature of the nodewatcher platform. 

\vspace{0.5cm}\noindent\textsc{Response}\\
TODO

\vspace{0.5cm}\noindent\textsc{Comment 3}\\
Another interesting comparison would be on the implications of different designs approaches. One examples is the issue of centrality, single-point of failure, and security which seems pretty neglected in the whole discussion but, to the best of my knowledge, plays a very important role in community networks.

\vspace{0.5cm}\noindent\textsc{Response}\\
TODO

\vspace{0.5cm}\noindent\textsc{Comment 4}\\
Another critical implication seems that the proposed system mandates exclusive configuration rights as any manual parameter change by a node-admin would violate the foreseen approach. This could also be considered a real burden when trying for example to test different parameters (eg when looking for link channels with least interference and highest TP in a given environment).

\vspace{0.5cm}\noindent\textsc{Response}\\
TODO

\vspace{0.5cm}\noindent\textsc{Comment 5}\\
It remains unclear to what extend the proposed system can indeed achieve its promises. An overview of successful adoptions by other communities or completely different (unforeseen by the original developers) scenarios would be interesting. The authors could describe in more detail since how long and with which acceptance and experience the new system (nodewatcher v3) has been used in their own community.

\vspace{0.5cm}\noindent\textsc{Response}\\
TODO

\end{document}
